"use strict";var SPMRequest;jQuery.datetimepicker.setLocale("pt"),jQuery("#calendario").datetimepicker({value:new Date,format:"d/m/Y H:00",closeOnDateSelect:!0,mask:!0}),jQuery("#calendar_icon").click(function(){jQuery("#calendario").datetimepicker("show")}),function(){var r="http://localhost:8080/v1/estacionamentos/",e=void 0;SPMRequest=function(){if(e)return e;function o(e,t){var a=new XMLHttpRequest;if(window.XMLHttpRequest)new XMLHttpRequest;else new ActiveXObject("Microsoft.XMLHTTP");a.open("GET",e,!0),a.onreadystatechange=function(){if(4==this.readyState){if(!(200<=this.status&&this.status<400))throw new Error(this.error);t(this.responseText)}},a.onerror=function(){throw new Error(this.error)},a.send()}return(e=this).getParkings=function(t){o(r,function(e){return t(JSON.parse(e))})},this.getDataByHour=function(e,t,a){o(r+e+"/findByHour?timestamp="+t,function(e){return a(JSON.parse(e))})},this.getDataByDay=function(e,t,a){o(r+e+"/findByDay?timestamp="+t,function(e){return a(JSON.parse(e))})},this.getDataByWeek=function(e,t,a){o(r+e+"/findByWeek?timestamp="+t,function(e){return a(JSON.parse(e))})},this.getDataByMonth=function(e,t,a){o(r+e+"/findByMonth?timestamp="+t,function(e){return a(JSON.parse(e))})},this.getDataByYear=function(e,t,a){o(r+e+"/findByYear?timestamp="+t,function(e){return a(JSON.parse(e))})},e}}();var Charts=function(r){var n=void 0,i={},s={},u=[],c={},l=function(){google.visualization.events.addListener(n,"select",function(){var e=n.getSelection();if(0<e.length&&null===e[0].row){var t=e[0].column;u[t]==t?(u[t]={label:i.getColumnLabel(t),type:i.getColumnType(t),calc:function(){return null}},c[t-1].color="#cccccc"):(u[t]=t,c[t-1].color=null);var a=new google.visualization.DataView(i);a.setColumns(u),n.draw(a,s)}})};return this.updateHourChart=function(e){for(var t=[["Minuto","Entrada","Saída","Fluxo"]],a=0;a<e.entrada.length;a++)t.push([5*(a+1)+"m",e.entrada[a],e.saida[a],Math.floor(Math.random()*e.entrada[a])-Math.floor(Math.random()*e.saida[a])]);i=google.visualization.arrayToDataTable(t),u=[],c={0:{},1:{},2:{type:"line"}};for(var o=0;o<i.getNumberOfColumns();o++)u.push(o),0<o&&o<3&&(c[o-1]={});s={seriesType:"bars",tooltip:{trigger:"selection"},aggregationTarget:"category",series:c,colors:["#77cfff","#eda477","#004684"],hAxis:{textStyle:{fontSize:12,color:"#053061"}},vAxis:{textStyle:{fontSize:14,color:"#053061"}},curveType:"function",pointSize:7},(n=new google.visualization.ComboChart(r)).draw(i,s),l()},this.updateDayChart=function(e){for(var t=[["Horário do dia","Entrada","Saída","Fluxo"]],a=0;a<e.entrada.length;a++)t.push([a+"h",e.entrada[a],e.saida[a],Math.floor(Math.random()*e.entrada[a])-Math.floor(Math.random()*e.saida[a])]);i=google.visualization.arrayToDataTable(t),u=[],c={0:{},1:{},2:{type:"line"}};for(var o=0;o<i.getNumberOfColumns();o++)u.push(o);s={seriesType:"bars",tooltip:{trigger:"selection"},aggregationTarget:"category",series:c,colors:["#77cfff","#eda477","#004684"],hAxis:{textStyle:{fontSize:12,color:"#053061"}},vAxis:{textStyle:{fontSize:14,color:"#053061"}},curveType:"function",pointSize:7},(n=new google.visualization.ComboChart(r)).draw(i,s),l()},this.updateWeekChart=function(e){var t=[["Dias da semana","Entrada"]];for(var a in e)t.push([a.slice(0,3).toUpperCase(),e[a].entrada.reduce(function(e,t){return e+t})]);i=google.visualization.arrayToDataTable(t),s={series:c={0:{}},colors:["#004684"],hAxis:{textStyle:{fontSize:12,color:"#053061"}},vAxis:{textStyle:{fontSize:14,color:"#053061"}}},(n=new google.visualization.ColumnChart(r)).draw(i,s)},this.updateMonthChart=function(e){var t=[["Dias do mês","Entrada"]];for(var a in e)for(var o in e[a])t.push([o.slice(0,1).toUpperCase(),e[a][o].entrada.reduce(function(e,t){return e+t})]);i=google.visualization.arrayToDataTable(t),s={series:c={0:{}},colors:["#004684"],hAxis:{textStyle:{fontSize:12,color:"#053061"}},vAxis:{textStyle:{fontSize:14,color:"#053061"}}},(n=new google.visualization.ColumnChart(r)).draw(i,s)},this.updateYearChart=function(e){i=new google.visualization.arrayToDataTable([["Meses do ano","Entrada"],["Jan",3e3],["Fev",3200],["Mar",2900],["Abr",3100],["Mai",2800],["Jun",1500],["Jul",500],["Ago",1500],["Set",1500],["Out",1500],["Nov",1500],["Dez",1500]]),s={series:c={0:{type:"line"}},colors:["#004684"],hAxis:{textStyle:{fontSize:12,color:"#053061"}},vAxis:{textStyle:{fontSize:14,color:"#053061"}},curveType:"function",pointSize:7},(n=new google.visualization.LineChart(r)).draw(i,s)},this.redrawChart=function(){n.draw(i,s)},this};!function(){var r=new SPMRequest,n=new Charts(document.querySelector("#Dia_chart_div")),u=[];function c(e,t,a){var o=!0;switch(e){case"Hora":r.getDataByHour(t,a,n.updateHourChart);break;case"Dia":r.getDataByDay(t,a,n.updateDayChart);break;case"Semana":r.getDataByWeek(t,a,n.updateWeekChart);break;case"Mês":r.getDataByMonth(t,a,n.updateMonthChart);break;case"Ano":n.updateYearChart(123);break;default:o=!1}return o}function t(e){var t,a,o=(t=document.querySelector("#form-estacionamento").value,void 0===(a=u.find(function(e){return e.name==t}))?-1:a.id);if(-1===o)return alert("Estacionamento inválido!");var r,n,i,s=(r=document.querySelector("#calendario").value,n=r.split(" "),(i=n[0].split("/"))[2]+"-"+i[1]+"-"+i[0]+" "+n[1]);return function(e){if(!e.match(/^\d{4}-\d{2}-\d{2}\ \d{2}:\d{2}$/))return!1;var t=new Date(e);return!Number.isNaN(t.getTime())}(s)?c(document.querySelector("#form-periodo").value,o,new Date(s).getTime())?void $("#filterModal").modal("hide"):alert("Período inválido!"):alert("Data inválida!")}function e(e){var a;u=e.estacionamentos,a=document.querySelector("#form-estacionamento"),u.map(function(e){return e.name}).forEach(function(e){var t=document.createElement("option");t.text=e,a.add(t)}),document.querySelector("#historicoSaveTrigger").addEventListener("click",t)}google.charts.load("current",{packages:["corechart"],language:"pt"}),google.charts.setOnLoadCallback(function(){c("Dia",0,(new Date).getTime()),r.getParkings(e),window.onresize=function(){n.redrawChart()}})}();