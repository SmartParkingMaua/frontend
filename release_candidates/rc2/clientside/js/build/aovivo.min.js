"use strict";var SPMRequest;!function(){var r="http://localhost:8080/v1/estacionamentos/",t=void 0;SPMRequest=function(){if(t)return t;function n(t,e){var a=new XMLHttpRequest;if(window.XMLHttpRequest)new XMLHttpRequest;else new ActiveXObject("Microsoft.XMLHTTP");a.open("GET",t,!0),a.onreadystatechange=function(){if(4==this.readyState){if(!(200<=this.status&&this.status<400))throw new Error(this.error);e(this.responseText)}},a.onerror=function(){throw new Error(this.error)},a.send()}return(t=this).getParkings=function(e){n(r,function(t){return e(JSON.parse(t))})},this.getDataByHour=function(t,e,a){n(r+t+"/findByHour?timestamp="+e,function(t){return a(JSON.parse(t))})},this.getDataByDay=function(t,e,a){n(r+t+"/findByDay?timestamp="+e,function(t){return a(JSON.parse(t))})},this.getDataByWeek=function(t,e,a){n(r+t+"/findByWeek?timestamp="+e,function(t){return a(JSON.parse(t))})},this.getDataByMonth=function(t,e,a){n(r+t+"/findByMonth?timestamp="+e,function(t){return a(JSON.parse(t))})},this.getDataByYear=function(t,e,a){n(r+t+"/findByYear?timestamp="+e,function(t){return a(JSON.parse(t))})},t}}();var Charts=function(n){var r=void 0,o={},i={};return this.updateHourChart=function(t){for(var e=[["Minuto","Fluxo"]],a=0;a<t.entrada.length;a++)e.push([5*(a+1)+"m",Math.floor(Math.random()*t.entrada[a])-Math.floor(Math.random()*t.saida[a])]);o=google.visualization.arrayToDataTable(e),i={series:{0:{type:"line"}},colors:["#004684"],hAxis:{textStyle:{fontSize:12,color:"#053061"}},vAxis:{textStyle:{fontSize:14,color:"#053061"}},curveType:"function",pointSize:7},(r=new google.visualization.LineChart(n)).draw(o,i)},this.updateDayChart=function(t){for(var e=[["Horário do dia","Fluxo"]],a=5;a<t.entrada.length;a++)e.push([a+"h",Math.floor(Math.random()*t.entrada[a])-Math.floor(Math.random()*t.saida[a])]);e.push(["0h",Math.floor(Math.random()*t.entrada[0])-Math.floor(Math.random()*t.saida[0])]),o=google.visualization.arrayToDataTable(e),i={series:{0:{type:"line"}},colors:["#004684"],hAxis:{textStyle:{fontSize:12,color:"#053061"}},vAxis:{textStyle:{fontSize:14,color:"#053061"}},curveType:"function",pointSize:7},(r=new google.visualization.LineChart(n)).draw(o,i)},this.updateAvailabilityChart=function(t){o=new google.visualization.arrayToDataTable([["Estado","Número de Carros"],["Disponíveis",143],["Ocupadas",157]]),i={series:{0:{},1:{}},colors:["#004684","#eda407"],pieHole:.25,legend:{position:"bottom"}},(r=new google.visualization.PieChart(n)).draw(o,i)},this.redrawChart=function(){r.draw(o,i)},this};!function(){var r=new SPMRequest,o=new Charts(document.querySelector("#Dia_chart_div")),i=new Charts(document.querySelector("#availability_chart")),n=[],u=void 0,s=3e4;function c(e){var t=n.find(function(t){return t.name==e});return void 0===t?-1:t.id}function d(t){for(var e=0,a=0,n=0;n<t.entrada.length;n++)e+=t.entrada[n],a+=t.saida[n];document.querySelector("#entrada").innerText=e,document.querySelector("#saida").innerText=a}function l(t,e,a){var n=!0;switch(t){case"Hora":r.getDataByHour(e,a,o.updateHourChart),r.getDataByDay(e,a,i.updateAvailabilityChart),r.getDataByHour(e,a,d);break;case"Dia":r.getDataByDay(e,a,o.updateDayChart),r.getDataByDay(e,a,i.updateAvailabilityChart),r.getDataByDay(e,a,d);break;default:n=!1}return n}function h(t){var e=c(document.querySelector("#form-estacionamento").value);if(-1===e)return alert("Estacionamento inválido!");var a=void 0;if(!l(a="LABEL"===t.target.tagName?t.target.innerText:document.querySelector("input[name=optionsAoVivo]:checked").parentNode.innerText,e,(new Date).getTime()))return alert("Período inválido!");clearInterval(u),u=setInterval(function(){var t=c(document.querySelector("#form-estacionamento").value);l(a,t,(new Date).getTime())},s),$("#filterModal").modal("hide")}function t(t){n=t.estacionamentos;var a,e=document.querySelector("#form-estacionamento");a=e,n.map(function(t){return t.name}).forEach(function(t){var e=document.createElement("option");e.text=t,a.add(e)}),e.addEventListener("click",h),document.querySelectorAll("input[name=optionsAoVivo]").forEach(function(t){return t.parentNode.addEventListener("click",h)}),u=setInterval(function(){l("Dia",0,(new Date).getTime())},s)}google.charts.load("current",{packages:["corechart"],language:"pt"}),google.charts.setOnLoadCallback(function(){l("Dia",0,(new Date).getTime()),r.getParkings(t),window.onresize=function(){o.redrawChart(),i.redrawChart()}})}();