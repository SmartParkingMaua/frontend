"use strict";var SPMRequest;!function(){var n="http://localhost:8080/v1/estacionamentos/",t=void 0;SPMRequest=function(){if(t)return t;function r(t,e){var a=new XMLHttpRequest;if(window.XMLHttpRequest)new XMLHttpRequest;else new ActiveXObject("Microsoft.XMLHTTP");a.open("GET",t,!0),a.onreadystatechange=function(){if(4==this.readyState){if(!(200<=this.status&&this.status<400))throw new Error(this.error);e(this.responseText)}},a.onerror=function(){throw new Error(this.error)},a.send()}return(t=this).getParkings=function(e){r(n,function(t){return e(JSON.parse(t))})},this.getDataByHour=function(t,e,a){r(n+t+"/findByHour?timestamp="+e,function(t){return a(JSON.parse(t))})},this.getDataByDay=function(t,e,a){r(n+t+"/findByDay?timestamp="+e,function(t){return a(JSON.parse(t))})},this.getDataByWeek=function(t,e,a){r(n+t+"/findByWeek?timestamp="+e,function(t){return a(JSON.parse(t))})},this.getDataByMonth=function(t,e,a){r(n+t+"/findByMonth?timestamp="+e,function(t){return a(JSON.parse(t))})},this.getDataByYear=function(t,e,a){r(n+t+"/findByYear?timestamp="+e,function(t){return a(JSON.parse(t))})},t}}();var chart=function(r){var n=void 0,o={},i={};return{drawHourChart:function(t){for(var e=[["Minuto","Fluxo"]],a=0;a<t.entrada.length;a++)e.push([5*(a+1)+"m",Math.floor(Math.random()*t.entrada[a])-Math.floor(Math.random()*t.saida[a])]);o=google.visualization.arrayToDataTable(e),i={colors:["#004684"],hAxis:{maxAlternation:1,textStyle:{fontSize:12,color:"#053061"}},vAxis:{format:"decimal",textStyle:{fontSize:14,color:"#053061"}},chartArea:{width:"75%",height:"80%"},curveType:"function",pointSize:7},n=new google.visualization.LineChart(r),n.draw(o,i)},drawDayChart:function(t){for(var e=[["Horário do dia","Fluxo"]],a=5;a<t.entrada.length;a++)e.push([a+1+"h",Math.floor(Math.random()*t.entrada[a])-Math.floor(Math.random()*t.saida[a])]);o=google.visualization.arrayToDataTable(e),i={colors:["#004684"],hAxis:{maxAlternation:1,textStyle:{fontSize:12,color:"#053061"}},vAxis:{format:"decimal",textStyle:{fontSize:14,color:"#053061"}},chartArea:{width:"75%",height:"80%"},curveType:"function",pointSize:7},n=new google.visualization.LineChart(r),n.draw(o,i)},drawAvailabilityChart:function(t){o=new google.visualization.arrayToDataTable([["Estado","Número de Carros"],["Disponíveis",143],["Ocupadas",157]]),i={colors:["#004684","#eda407"],chartArea:{top:"3%",width:"80%",height:"80%"},pieHole:.25,legend:{position:"bottom",textStyle:{fontSize:12,color:"#053061"}}},n=new google.visualization.PieChart(r),n.draw(o,i)},redrawChart:function(){n.draw(o,i)}}};!function(){var o=3e4,n=new SPMRequest,i=chart(document.querySelector("#aovivo-chart-main")),c=chart(document.querySelector("#aovivo-chart-availability")),u=document.querySelector("#aovivo-filter-parking"),s=document.querySelectorAll("input[name=aovivo-filter-period]"),l=[],d=void 0;function e(t){(l=t.estacionamentos).map(function(t){return t.name}).forEach(function(t){var e=document.createElement("option");e.text=t,u.add(e)}),h("Dia",0,(new Date).getTime()),d=setInterval(function(){h("Dia",0,(new Date).getTime())},o),s.forEach(function(t){return t.parentNode.addEventListener("click",a)}),u.addEventListener("click",a),window.onresize=function(){i.redrawChart(),c.redrawChart()}}function h(t,e,a){var r=!0;switch(t.toUpperCase()){case"HORA":n.getDataByHour(e,a,i.drawHourChart),n.getDataByDay(e,a,c.drawAvailabilityChart),n.getDataByHour(e,a,f);break;case"DIA":n.getDataByDay(e,a,i.drawDayChart),n.getDataByDay(e,a,c.drawAvailabilityChart),n.getDataByDay(e,a,f);break;default:r=!1}return r}function a(t){var e=void 0;"LABEL"===t.target.tagName?e=t.target.innerText:s.forEach(function(t){t.checked&&(e=t.parentNode.innerText)});var a,r,n=(a=u.value,void 0===(r=l.find(function(t){return t.name===a}))?-1:r.id);return-1===n?alert("Estacionamento inválido!"):h(e,n,(new Date).getTime())?(clearInterval(d),void(d=setInterval(function(){h(e,n,(new Date).getTime())},o))):alert("Período inválido!")}function f(t){for(var e=document.querySelector("#aovivo-total-entrance"),a=document.querySelector("#aovivo-total-exit"),r=0,n=0,o=0;o<t.entrada.length;o++)r+=t.entrada[o],n+=t.saida[o];e.innerText=r,a.innerText=n}google.charts.load("current",{packages:["corechart"],language:"pt"}),google.charts.setOnLoadCallback(function(t){return n.getParkings(e)})}();